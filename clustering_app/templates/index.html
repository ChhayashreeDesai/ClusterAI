{% extends "base.html" %}

{% block title %}Customer Clustering Analytics - Upload Your Data{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section">
    <div class="container">
        <div class="row align-items-center min-vh-50">
            <div class="col-lg-6">
                <div class="hero-content">
                    <h1 class="display-4 fw-bold mb-4 text-gradient">
                        <i class="fas fa-users me-3"></i>
                        Customer Clustering Analytics
                    </h1>
                    <p class="lead mb-4 text-muted">
                        Transform your customer data into actionable insights with advanced machine learning clustering algorithms. 
                        Upload your CSV file and get comprehensive customer segmentation analysis in seconds.
                    </p>
                    
                    <div class="feature-badges mb-4">
                        <span class="badge bg-primary me-2 mb-2">
                            <i class="fas fa-chart-line me-1"></i> K-Means
                        </span>
                        <span class="badge bg-success me-2 mb-2">
                            <i class="fas fa-project-diagram me-1"></i> Agglomerative
                        </span>
                        <span class="badge bg-info me-2 mb-2">
                            <i class="fas fa-search me-1"></i> DBSCAN
                        </span>
                        <span class="badge bg-warning text-dark me-2 mb-2">
                            <i class="fas fa-brain me-1"></i> Auto-Optimization
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6">
                <div class="upload-card">
                    <div class="card shadow-lg border-0">
                        <div class="card-body p-4">
                            <div class="text-center mb-4">
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h3 class="card-title mt-3">Upload Your Data</h3>
                                <p class="text-muted">Select a CSV file to begin analysis</p>
                            </div>
                            
                            <form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data" id="uploadForm">
                                <div class="upload-area" id="uploadArea">
                                    <input type="file" id="fileInput" name="file" accept=".csv" required style="display: none;">
                                    <div class="upload-content">
                                        <i class="fas fa-file-csv fa-3x mb-3 text-primary"></i>
                                        <h5>Drop your CSV file here</h5>
                                        <p class="text-muted">or <a href="#" onclick="document.getElementById('fileInput').click()">browse files</a></p>
                                        <small class="text-muted">
                                            <i class="fas fa-info-circle me-1"></i>
                                            Maximum file size: 16MB
                                        </small>
                                    </div>
                                </div>
                                
                                <div class="file-info d-none" id="fileInfo">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <div class="d-flex align-items-center">
                                            <i class="fas fa-file-csv text-success me-2"></i>
                                            <span id="fileName"></span>
                                        </div>
                                        <button type="button" class="btn btn-sm btn-outline-danger" onclick="clearFile()">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn btn-primary btn-lg w-100 mt-3" id="analyzeBtn" disabled>
                                    <span class="analyze-text">
                                        <i class="fas fa-magic me-2"></i> Analyze Data
                                    </span>
                                    <span class="loading-text d-none">
                                        <i class="fas fa-spinner fa-spin me-2"></i> Processing...
                                    </span>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Features Section -->
<section id="features" class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">Powerful Analytics Features</h2>
            <p class="lead text-muted">Everything you need for comprehensive customer segmentation</p>
        </div>
        
        <div class="row g-4">
            <div class="col-lg-4 col-md-6">
                <div class="feature-card h-100">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-primary text-white rounded-circle mx-auto mb-3">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h5 class="card-title">Multiple Algorithms</h5>
                            <p class="card-text text-muted">
                                K-Means, Agglomerative, and DBSCAN clustering with automatic parameter optimization.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6">
                <div class="feature-card h-100">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-success text-white rounded-circle mx-auto mb-3">
                                <i class="fas fa-brain"></i>
                            </div>
                            <h5 class="card-title">Smart Optimization</h5>
                            <p class="card-text text-muted">
                                Automatic elbow and silhouette analysis to find the optimal number of clusters.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6">
                <div class="feature-card h-100">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-info text-white rounded-circle mx-auto mb-3">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <h5 class="card-title">Interactive Visualizations</h5>
                            <p class="card-text text-muted">
                                Beautiful, interactive charts and graphs powered by Plotly for better insights.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6">
                <div class="feature-card h-100">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-warning text-white rounded-circle mx-auto mb-3">
                                <i class="fas fa-users"></i>
                            </div>
                            <h5 class="card-title">Customer Segmentation</h5>
                            <p class="card-text text-muted">
                                Detailed customer profiles with demographics, behavior patterns, and business insights.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6">
                <div class="feature-card h-100">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-danger text-white rounded-circle mx-auto mb-3">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <h5 class="card-title">Marketing Strategy</h5>
                            <p class="card-text text-muted">
                                Actionable marketing recommendations and ROI analysis for each customer segment.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6">
                <div class="feature-card h-100">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-secondary text-white rounded-circle mx-auto mb-3">
                                <i class="fas fa-download"></i>
                            </div>
                            <h5 class="card-title">Export Reports</h5>
                            <p class="card-text text-muted">
                                Download comprehensive analysis reports and visualizations for presentations.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold">How It Works</h2>
            <p class="lead text-muted">Simple steps to get powerful insights</p>
        </div>
        
        <div class="row g-4">
            <div class="col-lg-4">
                <div class="text-center">
                    <div class="step-number bg-primary text-white rounded-circle mx-auto mb-3">1</div>
                    <h5>Upload CSV Data</h5>
                    <p class="text-muted">Upload your customer data in CSV format. We support various data formats and sizes.</p>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="text-center">
                    <div class="step-number bg-success text-white rounded-circle mx-auto mb-3">2</div>
                    <h5>AI Processing</h5>
                    <p class="text-muted">Our advanced algorithms analyze your data and find optimal customer segments automatically.</p>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="text-center">
                    <div class="step-number bg-info text-white rounded-circle mx-auto mb-3">3</div>
                    <h5>Get Insights</h5>
                    <p class="text-muted">Receive detailed analysis, visualizations, and actionable business recommendations.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Sample Data Format -->
<section id="about" class="py-5 bg-light">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h2 class="display-6 fw-bold mb-4">Data Format Requirements</h2>
                <p class="lead mb-4">
                    For best results, your CSV file should contain customer data with numerical columns for clustering analysis.
                </p>
                
                <ul class="list-unstyled">
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <strong>Customer ID:</strong> Unique identifier for each customer
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <strong>Demographics:</strong> Age, Gender, Location (optional)
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <strong>Financial Data:</strong> Income, Spending Score, Purchase Amount
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <strong>Behavioral Data:</strong> Frequency, Recency, Loyalty Score
                    </li>
                </ul>
            </div>
            
            <div class="col-lg-6">
                <div class="code-example">
                    <div class="card">
                        <div class="card-header bg-dark text-white">
                            <i class="fas fa-table me-2"></i>Sample Data Format
                        </div>
                        <div class="card-body p-0">
                            <table class="table table-sm mb-0">
                                <thead class="table-dark">
                                    <tr>
                                        <th>CustomerID</th>
                                        <th>Age</th>
                                        <th>Gender</th>
                                        <th>Income</th>
                                        <th>SpendingScore</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>25</td>
                                        <td>Male</td>
                                        <td>45000</td>
                                        <td>75</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>32</td>
                                        <td>Female</td>
                                        <td>68000</td>
                                        <td>62</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>28</td>
                                        <td>Male</td>
                                        <td>52000</td>
                                        <td>88</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
// File upload handling
const uploadArea = document.getElementById('uploadArea');
const fileInput = document.getElementById('fileInput');
const fileInfo = document.getElementById('fileInfo');
const fileName = document.getElementById('fileName');
const analyzeBtn = document.getElementById('analyzeBtn');
const uploadForm = document.getElementById('uploadForm');

// Drag and drop functionality
uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('drag-over');
});

uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('drag-over');
});

uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('drag-over');
    
    const files = e.dataTransfer.files;
    if (files.length > 0 && files[0].type === 'text/csv') {
        fileInput.files = files;
        showFileInfo(files[0]);
    }
});

uploadArea.addEventListener('click', () => {
    fileInput.click();
});

fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
        showFileInfo(e.target.files[0]);
    }
});

function showFileInfo(file) {
    fileName.textContent = file.name;
    fileInfo.classList.remove('d-none');
    uploadArea.style.display = 'none';
    analyzeBtn.disabled = false;
}

function clearFile() {
    fileInput.value = '';
    fileInfo.classList.add('d-none');
    uploadArea.style.display = 'block';
    analyzeBtn.disabled = true;
}

// Form submission with loading state
uploadForm.addEventListener('submit', (e) => {
    const analyzeText = document.querySelector('.analyze-text');
    const loadingText = document.querySelector('.loading-text');
    
    analyzeText.classList.add('d-none');
    loadingText.classList.remove('d-none');
    analyzeBtn.disabled = true;
});
</script>
{% endblock %}